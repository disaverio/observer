"use strict";!function(a,b){function c(a){return Array.isArray?Array.isArray(a):void 0!==a&&a&&a.constructor===Array}function d(b){if(b){for(var c=[],d=0;d<b.length;d++)b[d].constructor===Function?c.push(b[d]()):b[d]==a.RETURNED_FROM_OBSERVED?c.push(j):c.push(b[d]);return c}}function e(b){function c(b){function c(a,b){return b.length>1?c(a[b[0]],b.slice(1)):a[b[0]]}if(b.firstParam==a.RETURNED_FROM_OBSERVED)var d=j;else if(b.firstParam.constructor===Function)var d=b.firstParam();else if(b.firstType==PRIMITIVE)var d=b.firstParam;else var d=c(a,b.firstParam.split("."));if(void 0==b.secondParam)return!!d;if(b.secondParam==a.RETURNED_FROM_OBSERVED)var e=j;else if(b.secondParam.constructor===Function)var e=b.secondParam();else if(b.secondType==PRIMITIVE)var e=b.secondParam;else var e=c(a,b.secondParam.split("."));switch(b.operator){case"===":return d===e;case"!==":return d!==e;case"==":return d==e;case"!=":return d!=e;case"<":return d<e;case"<=":return d<=e;case">":return d>e;case">=":return d>=e;default:return!1}}if(!b)return!0;if("CONDITION"==b.type)return c(b);if("AND"==b.operator){for(var d=0;d<b.sons.length;d++){var f=e(b.sons[d]);if(!f)return!1}return!0}if("OR"==b.operator){for(var d=0;d<b.sons.length;d++){var f=e(b.sons[d]);if(f)return!0}return!1}return"NOT"==b.operator?!e(b.sons[0]):void 0}function f(b){function d(a){if("OR"!=a[0]&&"AND"!=a[0]&&"NOT"!=a[0])throw new Error("Observer | Unknown operator: '"+a[0]+"'");if("NOT"==a[0]&&2!=a.length)throw new Error("Observer | 'NOT' operator must have only one argument.");if(("OR"==a[0]||"AND"==a[0])&&a.length<=2)throw new Error("Observer | '"+a[0]+"' operator must have at least two arguments.");var b={type:"OPERATOR",operator:a[0],sons:[]};return a.slice(1).forEach(function(a){c(a)?b.sons.push(d(a)):b.sons.push(e(a))}),b}function e(b){if(!b||!b.firstParam)throw new Error("Observer | Invalid condition: "+b.operator);if(b.operator&&"==="!=b.operator&&"!=="!=b.operator&&"=="!=b.operator&&"!="!=b.operator&&">"!=b.operator&&">="!=b.operator&&"<"!=b.operator&&"<="!=b.operator)throw new Error("Observer | Unknown operator: '"+b.operator+"'");return{type:"CONDITION",firstParam:b.firstParam,firstType:b.firstType||a,operator:b.operator||"==",secondParam:b.secondParam,secondType:b.secondType||a}}if(b)return c(b)?d(b):e(b)}function g(a){return this.subscribers.push({fn:a.fn,conditions:f(a.conditions),params:a.params}),this}function h(a){for(var b=this.subscribers.length-1;b>=0;b--)this.subscribers[b].fn==a&&this.subscribers.splice(b,1);return this}function i(){return this.subscribers=[],this}a.RETURNED_FROM_OBSERVED=Math.random(),a.PRIMITIVE=Math.random();var j;Function.prototype.observable=function(){var a=this,b=function(){return j=a.apply(this,arguments),b.subscribers.forEach(function(a){e(a.conditions)&&a.fn.apply(null,d(a.params))}),j};return b.subscribers=[],b.addObserver=g.bind(b),b.removeObserver=h.bind(b),b.removeAllObservers=i.bind(b),b}}(this);